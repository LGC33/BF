---
weight: 1
title: "CVE-2021-23440"
---
# [CVE-2021-23440 - Type Mismatch bypassing Input Validation](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-23440)

### BF Taxonomy

{{< img src="images/CVE-2021-23440--a.png" height="130" caption="Fig 1. First BF chain: Loose comparison misuse." >}}

<ul>

[TCM](/Classes/_DAT/TCM.md) (Evaluate)

</ul>

{{< rawhtml >}}
<ul><strong>Cause: </strong><cause>Improper Operation</cause> - Wrong</ul>
<ul><strong>Attributes: </strong>
  <ul>Mechanism: <attribute>Operator</attribute></ul>
  <ul>Source Code: <attribute>Codebase</attribute></ul>
  <ul>Data Value Kind: <attribute>Boolean</attribute></ul>
  <ul>Data Type Kind: <attribute>Structured</attribute></ul>
</ul>
<ul><strong>Consequence: </strong><consequence>Improper Data Value</consequence> - Wrong Result </ul>
{{< /rawhtml >}}

{{< img src="images/CVE-2021-23440--b.png" height="350" caption="Fig 2. Second BF chain: Conversion missing before loose comparison." >}}

<ul>

[TCV](/Classes/_DAT/TCV.md) (Cast)

</ul>

{{< rawhtml >}}
<ul><strong>Cause: </strong><cause>Improper Operation</cause> - Missing</ul>
<ul><strong>Attributes: </strong>
  <ul>Mechanism: <attribute>Pass In</attribute></ul>
  <ul>Source Code: <attribute>Codebase</attribute></ul>
  <ul>Data Value Kind: <attribute>Text</attribute></ul>
  <ul>Data Type Kind: <attribute>Structured</attribute></ul>
</ul>

<ul><strong>Consequence: </strong><consequence>Improper DataType</consequence> - Wrong Type ( nested list with [<code>‘_proto_’’</code>] instead of <code>string</code> value </ul>
{{< /rawhtml >}}

<ul>

[DVL](/Classes/_INP/DVL.md) (Validate)

</ul>

{{< rawhtml >}}
<ul><strong>Cause: </strong><cause>Improper Data</cause> - Tampered Data
    ( nested list with[<code>‘_proto_’’</code>] )</ul>
<ul><strong>Attributes: </strong>
  <ul>Mechanism: <attribute>Safelist</attribute></ul>
  <ul>Source Code: <attribute>Codebase</attribute></ul>
  <ul>Execution Space: <attribute>Local/attribute></ul>
  <ul>Data State: <attribute>Entered</attribute></ul>
</ul>
<ul><strong>Consequence: </strong><consequence>Injection Error</consequence> - Command Injection </ul>



 <p><h3>BF Description:</h3></p>
<p><ul>The package set-value for JavaScript is vulnerable to prototype pollution in versions
    &lt;2.0.1, >=3.0.0, &lt;4.0.1. It happens due to a type mismatch in the prototype pollution verification.</ul></p>
 <p><h3>CVE Description</h3></p>
 <p></p>
<p>
<h3>Analysis</h3>
</p>
<p>
<ul>This vulnerability has two possible BF chains. The first chain is: the loose comparison operator is misused. The
    second chain is: a type conversion is missing before using the loose comparison, leading to improper input
    validation and prototype pollution, a kind of command injection in JavaScript.</ul>
</p>
<p>
<h3>The Fix</h3>
</p>
<p>
<ul>There are two ways of fixing this vulnerability: the developers could use strict comparison, solving the TCM bug, or they could do a type conversion before the loose comparison. They chose the latter.</ul>
</p>
{{< /rawhtml >}}